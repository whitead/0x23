!function(e,n,o,r,t){var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i="function"==typeof s.parcelRequirea706&&s.parcelRequirea706,l=i.cache||{},a="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function d(n,o){if(!l[n]){if(!e[n]){var r="function"==typeof s.parcelRequirea706&&s.parcelRequirea706;if(!o&&r)return r(n,!0);if(i)return i(n,!0);if(a&&"string"==typeof n)return a(n);var t=new Error("Cannot find module '"+n+"'");throw t.code="MODULE_NOT_FOUND",t}u.resolve=function(o){var r=e[n][1][o];return null!=r?r:o},u.cache={};var c=l[n]=new d.Module(n);e[n][0].call(c.exports,u,c,c.exports,this)}return l[n].exports;function u(e){var n=u.resolve(e);return!1===n?{}:d(n)}}d.isParcelRequire=!0,d.Module=function(e){this.id=e,this.bundle=d,this.exports={}},d.modules=e,d.cache=l,d.parent=i,d.register=function(n,o){e[n]=[function(e,n){n.exports=o},{}]},Object.defineProperty(d,"root",{get:function(){return s.parcelRequirea706}}),s.parcelRequirea706=d;for(var c=0;c<n.length;c++)d(n[c]);var u=d(o);"object"==typeof exports&&"undefined"!=typeof module?module.exports=u:"function"==typeof define&&define.amd&&define((function(){return u}))}({e2GVl:[function(e,n,o){var r=e("@parcel/transformer-js/src/esmodule-helpers.js"),t=e("./selfies");r.interopDefault(t);importScripts("https://cdn.jsdelivr.net/pyodide/v0.21.3/full/pyodide.js");const s={decoder:e=>null,encoder:e=>null,pyodideLoaded:"loading",selfiesLoaded:"loading"};onmessage=e=>{const n=e.data,o=n[0],r=n[1];let t="";"loading-status"===o?t={pyodide:s.pyodideLoaded,selfies:s.selfiesLoaded}:"encoder"===o?t=s.encoder(n[2]):"decoder"===o?t=s.decoder(n[2]):"vocab-size"===o&&(t=s.vocabSize),postMessage([o,r,t])},loadPyodide().then((e=>{s.pyodideLoaded="loaded",e.loadPackage("micropip").then((()=>{e.runPythonAsync('\n            import micropip\n            await micropip.install(\'selfies==2\')\n            import selfies as sf\n            def get_basic_alphabet():\n                a = sf.get_semantic_robust_alphabet().copy()\n                # remove cations/anions except oxygen anion\n                to_remove = []\n                for ai in a:\n                    if "+1" in ai:\n                        to_remove.append(ai)\n                    elif "-1" in ai:\n                        to_remove.append(ai)\n                # remove [P],[#P],[=P]\n                to_remove.extend(["[P]", "[#P]", "[=P]"])\n\n                a -= set(to_remove)\n                a.add("[O-1]")\n                a = list(sorted(a))\n                symbol_to_idx = {s: i for i, s in enumerate(a)}\n                return symbol_to_idx\n            vocab_stoi = get_basic_alphabet()\n            vocab_itos = {v: k for k, v in vocab_stoi.items()}\n            vocab_size = len(vocab_stoi)\n            def encoder(s):\n                s = sf.encoder(s)\n                return sf.selfies_to_encoding(s, vocab_stoi, enc_type=\'label\')\n            def decoder(s):\n                s = sf.encoding_to_selfies(s, vocab_itos, enc_type=\'label\')\n                return sf.decoder(s)\n        ',(e=>{s.pyodideLoaded="failed",s.selfiesLoaded="failed"})).then((()=>{s.selfiesLoaded="loaded";const n=e.globals.get("vocab_size");s.vocabSize=n;const o=e.globals.get("decoder");s.decoder=e=>{try{return o(e)}catch(e){return console.log(e),null}};const r=e.globals.get("encoder");s.encoder=e=>{try{return r(e).toJs()}catch(e){return console.log(e),null}}}))}),(e=>{s.selfiesLoaded="failed"}))}))},{"./selfies":"b7BEu","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],b7BEu:[function(e,n,o){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(o);let r=null;const t={};let s=0;const i=1024;let l=null;const a={startSelfiesWorker:()=>{if(null!==r)return;"file:///src/components/lib/selfies/selfies.js".replace(/[^/]*$/,"");const n=new URL(e("bf0aa564a5555879"));r=new Worker(n),r.onmessage=e=>{const n=e.data,o=n[1],r=n[2];"vocab-size"===n[0]&&(l=r),t[o](r),delete t[o]}},selfiesLoadStatus:()=>null===r?new Promise((e=>e({pyodide:"waiting",selfies:"waiting"}))):(s=(s+1)%i,r.postMessage(["loading-status",s,null]),new Promise((e=>t[s]=e))),decoder:e=>null===r?new Promise(((e,n)=>n(new Error("Must call startSelfiesWorker() first")))):(s=(s+1)%i,r.postMessage(["decoder",s,e]),new Promise((e=>t[s]=e))),encoder:e=>null===r?new Promise(((e,n)=>n(new Error("Must call startSelfiesWorker() first")))):(s=(s+1)%i,r.postMessage(["encoder",s,e]),new Promise((e=>t[s]=e))),vocabSize:()=>null===l?null===r?new Promise(((e,n)=>n(new Error("Must call startSelfiesWorker() first")))):(s=(s+1)%i,r.postMessage(["vocab-size",s,null]),new Promise((e=>t[s]=e))):new Promise((e=>e(l)))};o.default=a},{bf0aa564a5555879:"hCMfg","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}],hCMfg:[function(e,n,o){n.exports=e("./helpers/bundle-url").getBundleURL("l3Aob")+e("./helpers/bundle-manifest").resolve("l3Aob")},{"./helpers/bundle-url":"a2ypy","./helpers/bundle-manifest":"gSiLw"}],a2ypy:[function(e,n,o){"use strict";var r={};function t(e){return(""+e).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}o.getBundleURL=function(e){var n=r[e];return n||(n=function(){try{throw new Error}catch(n){var e=(""+n.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(e)return t(e[2])}return"/"}(),r[e]=n),n},o.getBaseURL=t,o.getOrigin=function(e){var n=(""+e).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^/]+/);if(!n)throw new Error("Origin not found");return n[0]}},{}],gSiLw:[function(e,n,o){"use strict";var r={};n.exports.register=function(e){for(var n=Object.keys(e),o=0;o<n.length;o++)r[n[o]]=e[n[o]]},n.exports.resolve=function(e){var n=r[e];if(null==n)throw new Error("Could not resolve bundle with id "+e);return n}},{}],jiucr:[function(e,n,o){o.interopDefault=function(e){return e&&e.__esModule?e:{default:e}},o.defineInteropFlag=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.exportAll=function(e,n){return Object.keys(e).forEach((function(o){"default"===o||"__esModule"===o||n.hasOwnProperty(o)||Object.defineProperty(n,o,{enumerable:!0,get:function(){return e[o]}})})),n},o.export=function(e,n,o){Object.defineProperty(e,n,{enumerable:!0,get:o})}},{}]},["e2GVl"],"e2GVl");
//# sourceMappingURL=selfies_worker.351dd092.js.map
